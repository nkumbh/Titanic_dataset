[Titanic_2303res106_NN.pdf](https://github.com/user-attachments/files/17495813/Titanic_2303res106_NN.pdf)
# -*- coding: utf-8 -*-
"""Titanic.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/11iNvp4hG4WWoFsIJG4o6klNqhy9ItaDQ

Import all required libraries
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

"""##1.   Load the Titanic dataset (train.csv) into a Dataframe."""

from google.colab import files
uploaded = files.upload()

titanic = pd.read_csv("train.csv")

"""

##2.   Explore the dataset to understand its structure, features, and missing values.

"""

titanic.head()

titanic.info()

"""**Check the null values at the data**"""

titanic.isnull().sum()

"""**we can remove null values column which are not important and not affecting the data. Like PassangerID, name, ticket, and cabin. **"""

titanic.drop(columns = ['PassengerId', 'Name', 'Ticket', 'Cabin'], inplace=True)

titanic.head()

"""**Check the duplicated values , then remove them.**"""

titanic.duplicated().sum()

titanic.drop_duplicates(inplace=True)

titanic.duplicated().sum()

titanic.info()

titanic.isnull().sum()

"""##3. Perform data cleaning and preprocessing steps:

**Handle missing data for Age using Group wise median method**
"""

def groupwise_imputation(df, column, by):
  return df[column].fillna(df.groupby(by)[column].transform('median'))

titanic['Age'] = groupwise_imputation(titanic, 'Age', 'Pclass')
titanic.head()

"""**Encode categorical variables (one-hot encoding)** **and hanbling missing value for Embarked.**"""

titanic_df = pd.get_dummies(titanic, columns=['Sex', 'Embarked'])

titanic.head()

titanic_df.isnull().sum()

"""Creating new feature "FamilySize"
"""

titanic_df['FamilySize'] = titanic['SibSp'] + titanic['Parch'] + 1

titanic_df.head()

"""##4. Visualize the data using appropriate plots and charts to extract insights:

•	Explore the distribution of passengers by Age
"""

plt.figure(figsize=(10, 6))
sns.histplot(titanic['Age'], bins=20, kde=True)
plt.title('Distribution of Passengers by Age')
plt.xlabel('Age')
plt.ylabel('Count')
plt.show()

"""The ages in the data most of the passengers the range of ages of them between the 15 to 40

•	Explore the distribution of passengers by Gender
"""

plt.figure(figsize=(5, 5))
sns.barplot(x='Sex', y='Survived', data=titanic)
plt.title('Survival Rate by Gender')
plt.xlabel('Gender')
plt.ylabel('Survival Rate')
plt.show()

"""•	Explore the distribution of passengers by Class"""

plt.figure(figsize=(8,4))
sns.barplot(x='Pclass', y='Survived', data=titanic)
plt.title('Survival Rate by Passenger Class')
plt.xlabel('Passenger Class')
plt.ylabel('Survival Rate')
plt.show()

"""•	Explore the distribution of passengers by Siblings or Spouse."""

plt.figure(figsize=(10,5))
sns.histplot(titanic_df['SibSp'], bins=20, kde=True, color='green')
plt.show()

"""At the above plot more of 500 passengers not have siblings in the titanic
Less than 200 passengers have 1 sibling in the titanic

•	Explore the distribution of passengers by Parents or Children
"""

plt.figure(figsize=(10,5))
sns.histplot(titanic_df['Parch'], bins=20, kde=True, color='green')
plt.show()

"""In above plot more than 500 passangers not have parents or children in titanic.

•	Explore the distribution of passengers by Embarked.
"""

embarical_num=titanic['Embarked'].value_counts(dropna=False)
embarical_num.index = embarical_num.index.where(~embarical_num.index.isna(), 'unknown')
embarical_num.plot(kind='bar',color='blue',figsize=(10,5))

"""In above graph
The number of passengers in the Southampton are more than 800 passengers
The number of passengers in the Cherbourg are less than 300 passengers
The number of passengers in the Queenstown are less than 100 passengers
Port of Embarkation C = Cherbourg, Q = Queenstown, S = Southampton

# Survival rates amongst different Groups and their correlations.
"""

survive_pclass=pd.crosstab(titanic_df.Survived,titanic_df.Pclass)
survive_pclass.plot(kind='bar',figsize=(10,4))

"""In the above graph the class 3 passangers died are arond 300 which is very large number compared to class 1 and 2. While class 1 pessangers survival rate is higher than the class 2 and 3."""

survive_sex=pd.crosstab(titanic.Survived,titanic.Sex)
survive_sex.plot(kind='bar',figsize=(5,5))

"""Above graph shows the number of male casualties are more than 350 while the female casualties are only arond 150.
The survived female are more than 200 in compare to survived male around 100.
"""

survive_SibSp=pd.crosstab(titanic.Survived,titanic.SibSp)
survive_SibSp.plot(kind='bar',figsize=(5,5))

"""Above graph shows the most number of survived people does not have siblings or spouse and also there are more than 300 people who died does not have siblings or spouse."""

survive_Parch=pd.crosstab(titanic.Survived,titanic.Parch)
survive_Parch.plot(kind='bar',figsize=(5,5))

"""Above graph shows the most number of survived people does not have paraents or child and also there are more than 350 people who died does not have paraents or child"""

survive_FamilySize=pd.crosstab(titanic_df.Survived,titanic_df.FamilySize)
survive_FamilySize.plot(kind='bar',figsize=(5,5))

survive_sex=pd.crosstab(titanic.Sex,titanic.Embarked)
ax=survive_sex.plot(kind='bar',figsize=(5,3))

"""In above graph the the number of male and female survived from different Embarked.

Number of female embarded from Cherbourg are 50-100,
Number of female embarded from Queenstown are less than 50
Number of female embarded from Southampton are 200

Similarly:
Number of male embarded from Cherbourg are around 100,
Number of male from Queenstown are less than 50
Number of male from Southampton are more than 350
"""

survive_Embarked=pd.crosstab(titanic.Survived,titanic.Embarked)
ax=survive_Embarked.plot(kind='bar',figsize=(5,3))

"""In above graph the the number of male and female survived from different Embarked.

Number of female survied are embarded from Cherbourg are 50-100,
Number of female survied are embarded from Queenstown are less than 50
Number of female survied are embarded from Southampton are 200

Similarly:
Number of male survied are embarded from Cherbourg are around 100,
Number of male survied are embarded from Queenstown are less than 50
Number of male survied are embarded from Southampton are more than 350
"""

plt.figure(figsize=(10, 6))
sns.heatmap(titanic.corr(), annot=True, cmap='coolwarm')
plt.title('Correlation Heatmap')
plt.show()

"""## Part 2: Building a Neural Network for Classification






"""

import tensorflow as tf
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import accuracy_score, confusion_matrix

"""**Split the dataset into features (X) and target variables (y)**"""

X = titanic_df.drop(columns=['Survived'])
y = titanic_df['Survived']

"""**Normalizing or scale the numerical features**"""

scaler = StandardScaler()
numerical_features = ['Age', 'Fare', 'FamilySize']
X[numerical_features] = scaler.fit_transform(X[numerical_features])

print(X.head())
print(y.head())

"""**Split the data into training and testing sets**"""

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

"""**Building a simple neural network model for binary classification**"""

model = tf.keras.Sequential([
    tf.keras.layers.Dense(128, activation='relu', input_shape=(X_train.shape[1],)),
    tf.keras.layers.Dense(64, activation='relu'),
    tf.keras.layers.Dense(32, activation='relu'),
    tf.keras.layers.Dense(1, activation='sigmoid')
])

"""**Compile the model with appropriate loss function and optimizer**"""

model.compile(optimizer='adam',
              loss='binary_crossentropy',
              metrics=['accuracy'])

"""#3. Train the neural network on the training data:"""

history = model.fit(X_train, y_train, epochs=50, batch_size=4, validation_split=0.2)

"""Evaluate the model's performance on the test set

#4. Evaluate the trained model on the testing data:
"""

test_loss, test_accuracy = model.evaluate(X_test, y_test)
print("Test Accuracy:", test_accuracy)

"""Calculate predictions and Calculate accuracy

"""

y_pred = model.predict(X_test)

y_pred = (y_pred > 0.5).astype("int")

accuracy = accuracy_score(y_test, y_pred)
print("Accuracy:", accuracy)

loss, accuracy = model.evaluate(X_test, y_test, verbose=1)

# Print the test accuracy
print(f"Test Accuracy: {accuracy}")

# Print the test loss
print(f"Test Loss: {loss}")

plt.figure(figsize=(6, 5))
sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='d', cmap='Reds')
plt.xlabel('Predicted labels')
plt.ylabel('True labels')
plt.title('Confusion Matrix')
plt.show()
